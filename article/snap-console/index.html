<!DOCTYPE html><html lang="en"><head><title>Snap Console - Ken‚Äôs Developer Portfolio</title><meta charSet="utf-8"/><link rel="icon" href="/_next/static/media/favicon.74f1eb8a.ico"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="description" content="A easy-to-use console library in Python to display beautiful outputs."/><meta name="language" content="english"/><meta name="copyright" content="Kenneth-LJS"/><meta name="distribution" content="global"/><meta property="og:title" content="Snap Console - Ken‚Äôs Developer Portfolio"/><meta property="og:type" content="website"/><meta property="og:url" content="https://www.kenneth-ljs.com/article/snap-console/"/><meta property="og:description" content="A easy-to-use console library in Python to display beautiful outputs."/><meta property="og:image" content="https://www.kenneth-ljs.com/article/snap-console/thumbnail.png"/><meta property="og:image:type" content="image/jpeg"/><meta property="og:image:width" content="1000"/><meta property="og:image:height" content="1000"/><meta property="twitter:card" content="summary_large_image"/><meta property="twitter:title" content="Snap Console - Ken‚Äôs Developer Portfolio"/><meta property="twitter:description" content="A easy-to-use console library in Python to display beautiful outputs."/><meta property="twitter:image" content="https://www.kenneth-ljs.com/article/snap-console/thumbnail.png"/><meta property="twitter:url" content="https://www.kenneth-ljs.com/article/snap-console/"/><meta property="twitter:domain" content="kenneth-ljs.com"/><link rel="preload" as="image" href="/article/snap-console/banner.webp"/><meta name="next-head-count" content="23"/><link rel="preload" href="/_next/static/css/96edbc607d4b17f0.css" as="style"/><link rel="stylesheet" href="/_next/static/css/96edbc607d4b17f0.css" data-n-g=""/><link rel="preload" href="/_next/static/css/581e0a3ec8a959c1.css" as="style"/><link rel="stylesheet" href="/_next/static/css/581e0a3ec8a959c1.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-ee7e63bc15b31913.js" defer=""></script><script src="/_next/static/chunks/framework-50116e63224baba2.js" defer=""></script><script src="/_next/static/chunks/main-3ee22cc5cd2ba8df.js" defer=""></script><script src="/_next/static/chunks/pages/_app-03bbd27282f070a7.js" defer=""></script><script src="/_next/static/chunks/757-71211cc05fe5710f.js" defer=""></script><script src="/_next/static/chunks/187-88a9c6f910f35f09.js" defer=""></script><script src="/_next/static/chunks/646-edf455176e521f43.js" defer=""></script><script src="/_next/static/chunks/pages/article/snap-console-2132962552221145.js" defer=""></script><script src="/_next/static/IE_95hG1yeH-F73W3v0y_/_buildManifest.js" defer=""></script><script src="/_next/static/IE_95hG1yeH-F73W3v0y_/_ssgManifest.js" defer=""></script><style id="__jsx-413896030">html{font-size:18px;color:#eee}body::before{z-index:-1;content:"";position:fixed;inset:0;background-image:url("/_next/static/media/bg.15d5bb7f.png");background-position:center;-webkit-background-size:cover;-moz-background-size:cover;-o-background-size:cover;background-size:cover;background-attachment:fixed;background-color:#1f2834;background-blend-mode:color-burn}</style></head><body><div id="__next"><div class="jsx-413896030 basic-layout_page__ZDOnt"><div id="top" class="jsx-413896030"></div><div class="nav_navPlaceholder__CWYB7"></div><div class="nav_navContainer__rjN75" style="z-index:1000"><nav class="nav_nav__W__TS"><div class="nav_navBrandContainer__63F1X"><a tabindex="0" href="/#top"><div class="nav_navBrandImgContainer__WnhV_" style="aspect-ratio:100 / 100"><img alt="LIFC Logo" src="/_next/static/media/logo.3a54d410.png" decoding="async" data-nimg="fill" loading="lazy" style="position:absolute;height:100%;width:100%;left:0;top:0;right:0;bottom:0;color:transparent"/></div></a></div><div class="nav_navMobileToggle__a5RSd" tabindex="0"><div class="nav_navMobileToggleBar1__i_RJs"></div><div class="nav_navMobileToggleBar2__RjpxR"></div><div class="nav_navMobileToggleBar3__hymqG"></div></div><div class="nav_navMobileToggleActiveBlock__Xbzk1"></div><div class="nav_navLinks__d901P"><div class="nav_navLinkContainer__9WK_y"><a class="nav_navLink__wzVGa" tabindex="0" href="/#about-me">About Me</a></div><div class="nav_navLinkContainer__9WK_y"><a class="nav_navLink__wzVGa" tabindex="0" href="/#experience">Experience</a></div><div class="nav_navLinkContainer__9WK_y"><a class="nav_navLink__wzVGa" tabindex="0" href="/#skills">Skills</a></div><div class="nav_navLinkContainer__9WK_y"><a class="nav_navLink__wzVGa" tabindex="0" href="/#portfolio">Portfolio</a></div><div class="nav_navLinkContainer__9WK_y"><a class="nav_navLink__wzVGa" tabindex="0" href="/#resume">Resume</a></div><div class="nav_navLinkContainer__9WK_y"><a class="nav_navLink__wzVGa" tabindex="0" href="/#contact">Contact</a></div></div></nav></div><div style="--inner-page-min-height:calc(100vh - 0px)" class="jsx-413896030 basic-layout_innerPage__VVAIz"><div class="page_headerContainer__rzIn8"><img alt="" src="/article/snap-console/banner.webp" decoding="async" data-nimg="fill" class="page_headerBackground__E1Yh7" style="position:absolute;height:100%;width:100%;left:0;top:0;right:0;bottom:0;color:transparent"/><div class="page_headerContent__FT7K_"><div class="page_markdown__21Yyp"><header>
<h1>Snap Console</h1>
<p>Making a powerful console library with Python descriptors, context, and the curses library; all because of a game</p>
<p><a href="https://github.com/Kenneth-LJS/snap-console" target="_blank" rel="noopener noreferrer">GitHub</a> | <a href="https://pypi.org/project/snap-console/" target="_blank" rel="noopener noreferrer">PyPI</a></p>
</header></div></div></div><div class="jsx-413896030 basic-layout_contentContainer__lVlG6"><main class="jsx-413896030 basic-layout_content__teZLy"><section class="section_sectionContent__Ecx81"><div style="--code-font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace"><div class="page_markdown__21Yyp"><h2>Raids and Notepad</h2>
<p>As an avid RuneScape player, I attend the Warband raids event that regularly happens. Multiple camps spawn on different worlds, each with their own resources. Players have to loot the resources before the camps despawn.</p>
<p>I have a clan that does the raids. We station people across different worlds to locate and call out the camps. To optimise the calls, we use acronyms.</p>
<ul>
<li>‚Äú12 dwf‚Äù means that a camp on world 12 has spawned at the Dark Warrior Fortress.
<ul>
<li>There are 3 possible spawn locations: Dark Warrior Fortress (DWF), East Lava Maze (ELM), and Red Dragon Isle (RDI).</li>
</ul>
</li>
<li>‚Äú86 msf‚Äù means that the resources on the world 86 camp are Mining, Smithing, and Farming.
<ul>
<li>Camps spawn with 3 of 5 resources: Construction, Farming, Herblore, Mining, and Smithing.</li>
</ul>
</li>
<li>‚Äú104 looting‚Äù means that the camp on world 104 is ready to be looted.
<ul>
<li>Camps need to be cleared before looting.</li>
</ul>
</li>
<li>‚Äú49 broken&quot; means that the camp on world 49 is broken.
<ul>
<li>Broken camps are camps that have failed to clear and cannot be looted.</li>
</ul>
</li>
<li>‚Äú19 8m‚Äù means that the camp on world 19 has 8 minutes of time left before despawning.</li>
</ul>
<p>As the tracker, I keep track of the camps: the world, location, resources, and despawn time. To do that, I have my friend Notepad.exe.</p>
<p align="center">
  <img src="./static/notepad.png" style="width:min(100%, 300px)"/>
</p>
<p>Not an ideal solution. I end up with duplicate worlds, scattered information (e.g. ‚Äú15 dwf‚Äù on one line, and ‚Äú15 msf‚Äù on another line), and I can‚Äôt even keep track of despawn times.</p>
<p>I turned to Python for help.</p>
<h2>Python</h2>
<p>In the first version of my raid tracker, I basically took all the inputs and sorted them by the world number.</p>
<pre><div style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-python" style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>world_calls </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#ccc">]</span><span>
</span>
<span></span><span class="token token" style="color:#cc99cd">while</span><span> </span><span class="token token" style="color:#f08d49">True</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>    user_input </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#cc99cd">input</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#7ec699">&#x27;Input: &#x27;</span><span class="token token" style="color:#ccc">)</span><span>
</span><span>    </span><span class="token token" style="color:#cc99cd">if</span><span> user_input </span><span class="token token" style="color:#67cdcc">==</span><span> </span><span class="token token" style="color:#7ec699">&#x27;exit&#x27;</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>        </span><span class="token token" style="color:#cc99cd">break</span><span>
</span>
<span>    world_calls</span><span class="token token" style="color:#ccc">.</span><span>append</span><span class="token token" style="color:#ccc">(</span><span>user_input</span><span class="token token" style="color:#ccc">)</span><span>
</span><span>    world_calls</span><span class="token token" style="color:#ccc">.</span><span>sort</span><span class="token token" style="color:#ccc">(</span><span>key</span><span class="token token" style="color:#67cdcc">=</span><span class="token token" style="color:#cc99cd">lambda</span><span> </span><span class="token token" style="color:#cc99cd">input</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#cc99cd">int</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#cc99cd">input</span><span class="token token" style="color:#ccc">.</span><span>split</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#7ec699">&#x27; &#x27;</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#f08d49">0</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">)</span><span>
</span><span>    </span><span class="token token" style="color:#cc99cd">for</span><span> world_call </span><span class="token token" style="color:#cc99cd">in</span><span> world_calls</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>        </span><span class="token token" style="color:#cc99cd">print</span><span class="token token" style="color:#ccc">(</span><span>world_call</span><span class="token token" style="color:#ccc">)</span><span>
</span><span>    </span><span class="token token" style="color:#cc99cd">print</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span></code></div></pre>
<p>Primitive, but it works.</p>
<pre><div style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>Input: </span><span class="token token" style="color:#f08d49">10</span><span> dwf
</span><span></span><span class="token token" style="color:#f08d49">10</span><span> dwf
</span>
<span>Input: </span><span class="token token" style="color:#f08d49">42</span><span> rdi
</span><span></span><span class="token token" style="color:#f08d49">10</span><span> dwf
</span><span></span><span class="token token" style="color:#f08d49">42</span><span> rdi
</span>
<span>Input: </span><span class="token token" style="color:#f08d49">10</span><span> msf
</span><span></span><span class="token token" style="color:#f08d49">10</span><span> dwf
</span><span></span><span class="token token" style="color:#f08d49">10</span><span> msf
</span><span></span><span class="token token" style="color:#f08d49">42</span><span> rdi</span></code></div></pre>
<p>With the world calls in order, it‚Äôs slightly easier to see calls organised by worlds.</p>
<p>But we can do better than this. After this, I added checks to combine the camp location, resources, and state.</p>
<pre><div style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>Input: </span><span class="token token" style="color:#f08d49">10</span><span> dwf
</span><span></span><span class="token token" style="color:#f08d49">10</span><span> dwf
</span>
<span>Input: </span><span class="token token" style="color:#f08d49">42</span><span> rdi
</span><span></span><span class="token token" style="color:#f08d49">10</span><span> dwf
</span><span></span><span class="token token" style="color:#f08d49">42</span><span> rdi
</span>
<span>Input: </span><span class="token token" style="color:#f08d49">10</span><span> msf
</span><span></span><span class="token token" style="color:#f08d49">10</span><span> dwf msf
</span><span></span><span class="token token" style="color:#f08d49">42</span><span> rdi
</span>
<span></span><span class="token token" style="color:#999"># The earlier call of 10 dwf was incorrect</span><span>
</span><span></span><span class="token token" style="color:#999"># so we update its location to elm</span><span>
</span><span>Input: </span><span class="token token" style="color:#f08d49">10</span><span> elm
</span><span></span><span class="token token" style="color:#f08d49">10</span><span> elm msf
</span><span></span><span class="token token" style="color:#f08d49">42</span><span> rdi</span></code></div></pre>
<p>Better, but there‚Äôs a final feature that the vanilla Python console cannot solve. I want to track the camp despawn times. If I type ‚Äú10 8m‚Äù, I want the script to show an 8-minute countdown timer beside the world. We can‚Äôt do that here because:</p>
<ol>
<li>The <code>input()</code> function is blocking, and nothing new can be printed until I enter something in the console.</li>
<li>Even if we used an asynchronous coroutine to do the printing, the world list will have to be reprinted every second to update the time, leading to a lot of flashing in the console.</li>
</ol>
<p>How do we fix this?</p>
<h2>Print()</h2>
<p>Let‚Äôs try to create a console that prints an incremental counter while echoing user input. First, we need an async function to handle the printing.</p>
<pre><div style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-python" style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token token" style="color:#cc99cd">async</span><span> </span><span class="token token" style="color:#cc99cd">def</span><span> </span><span class="token token" style="color:#f08d49">console_counter</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>    counter </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#f08d49">1</span><span>
</span><span>    </span><span class="token token" style="color:#cc99cd">while</span><span> </span><span class="token token" style="color:#f08d49">True</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>        </span><span class="token token" style="color:#cc99cd">await</span><span> asyncio</span><span class="token token" style="color:#ccc">.</span><span>sleep</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#f08d49">1</span><span class="token token" style="color:#ccc">)</span><span>
</span><span>        </span><span class="token token" style="color:#cc99cd">print</span><span class="token token" style="color:#ccc">(</span><span class="token token string-interpolation" style="color:#7ec699">f&#x27;Counter: </span><span class="token token string-interpolation interpolation" style="color:#ccc">{</span><span class="token token string-interpolation interpolation">counter</span><span class="token token string-interpolation interpolation" style="color:#ccc">}</span><span class="token token string-interpolation" style="color:#7ec699">&#x27;</span><span class="token token" style="color:#ccc">)</span><span>
</span><span>        counter </span><span class="token token" style="color:#67cdcc">+=</span><span> </span><span class="token token" style="color:#f08d49">1</span></code></div></pre>
<p>Then we set up the script to run the coroutine asynchronously.</p>
<pre><div style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-python" style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token token" style="color:#cc99cd">import</span><span> asyncio
</span>
<span></span><span class="token token" style="color:#cc99cd">async</span><span> </span><span class="token token" style="color:#cc99cd">def</span><span> </span><span class="token token" style="color:#f08d49">main</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>    asyncio</span><span class="token token" style="color:#ccc">.</span><span>create_task</span><span class="token token" style="color:#ccc">(</span><span>console_counter</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">)</span><span>
</span>
<span>    </span><span class="token token" style="color:#999"># We&#x27;ll take user input here</span><span>
</span>    
<span>    </span><span class="token token" style="color:#cc99cd">await</span><span> asyncio</span><span class="token token" style="color:#ccc">.</span><span>sleep</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#f08d49">10</span><span class="token token" style="color:#ccc">)</span><span>
</span>
<span>asyncio</span><span class="token token" style="color:#ccc">.</span><span>run</span><span class="token token" style="color:#ccc">(</span><span>main</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">)</span></code></div></pre>
<p align="center">
  <video src="./static/counter.mp4" style="width:min(100%, 800px)" preload="auto" muted="" autoplay="" loop="" playsinline="" data-wf-ignore="true" data-object-fit="cover">
</video></p>
<p>The display counts from 1 to 9, then the program terminates once the 10-second sleep has run out. Now, let‚Äôs take user input and echo it back to the user.</p>
<pre><div style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-python" style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token token" style="color:#cc99cd">async</span><span> </span><span class="token token" style="color:#cc99cd">def</span><span> </span><span class="token token" style="color:#f08d49">main</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>    asyncio</span><span class="token token" style="color:#ccc">.</span><span>create_task</span><span class="token token" style="color:#ccc">(</span><span>console_counter</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">)</span><span>
</span>
<span>    </span><span class="token token" style="color:#cc99cd">print</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#7ec699">&#x27;Type anything and press &quot;Enter&quot;&#x27;</span><span class="token token" style="color:#ccc">)</span><span>
</span><span>    </span><span class="token token" style="color:#cc99cd">while</span><span> </span><span class="token token" style="color:#f08d49">True</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>        user_input </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#cc99cd">input</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span>
</span><span>        </span><span class="token token" style="color:#cc99cd">if</span><span> </span><span class="token token" style="color:#cc99cd">len</span><span class="token token" style="color:#ccc">(</span><span>user_input</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">==</span><span> </span><span class="token token" style="color:#f08d49">0</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>            exit</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span>
</span>
<span>        </span><span class="token token" style="color:#cc99cd">print</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#7ec699">&#x27;ECHO: &#x27;</span><span> </span><span class="token token" style="color:#67cdcc">+</span><span> user_input</span><span class="token token" style="color:#ccc">)</span></code></div></pre>
<p>Let‚Äôs check the printout.</p>
<p align="center">
  <video src="./static/counter-input.mp4" style="width:min(100%, 800px)" preload="auto" muted="" autoplay="" loop="" playsinline="" data-wf-ignore="true" data-object-fit="cover">
</video></p>
<p>Huh. The console counter doesn‚Äôt print the counts. It turns out that <code>input</code> is a blocking function, which means other coroutines cannot run while we are waiting for user input. To make this work, we have to use threads.</p>
<pre><div style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-python" style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token token" style="color:#cc99cd">import</span><span> threading
</span><span></span><span class="token token" style="color:#cc99cd">import</span><span> time
</span>
<span></span><span class="token token" style="color:#cc99cd">def</span><span> </span><span class="token token" style="color:#f08d49">console_counter</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>    counter </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#f08d49">1</span><span>
</span><span>    </span><span class="token token" style="color:#cc99cd">while</span><span> </span><span class="token token" style="color:#f08d49">True</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>        time</span><span class="token token" style="color:#ccc">.</span><span>sleep</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#f08d49">1</span><span class="token token" style="color:#ccc">)</span><span>
</span><span>        </span><span class="token token" style="color:#cc99cd">print</span><span class="token token" style="color:#ccc">(</span><span class="token token string-interpolation" style="color:#7ec699">f&#x27;Counter: </span><span class="token token string-interpolation interpolation" style="color:#ccc">{</span><span class="token token string-interpolation interpolation">counter</span><span class="token token string-interpolation interpolation" style="color:#ccc">}</span><span class="token token string-interpolation" style="color:#7ec699">&#x27;</span><span class="token token" style="color:#ccc">)</span><span>
</span><span>        counter </span><span class="token token" style="color:#67cdcc">+=</span><span> </span><span class="token token" style="color:#f08d49">1</span><span>
</span>
<span>console_counter_thread </span><span class="token token" style="color:#67cdcc">=</span><span> threading</span><span class="token token" style="color:#ccc">.</span><span>Thread</span><span class="token token" style="color:#ccc">(</span><span>
</span><span>    target</span><span class="token token" style="color:#67cdcc">=</span><span>console_counter</span><span class="token token" style="color:#ccc">,</span><span>
</span><span>    daemon</span><span class="token token" style="color:#67cdcc">=</span><span class="token token" style="color:#f08d49">True</span><span>
</span><span></span><span class="token token" style="color:#ccc">)</span><span>
</span><span>console_counter_thread</span><span class="token token" style="color:#ccc">.</span><span>start</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span>
</span>
<span></span><span class="token token" style="color:#cc99cd">print</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#7ec699">&#x27;Type anything and press &quot;Enter&quot;&#x27;</span><span class="token token" style="color:#ccc">)</span><span>
</span><span></span><span class="token token" style="color:#cc99cd">while</span><span> </span><span class="token token" style="color:#f08d49">True</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>    user_input </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#cc99cd">input</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span>
</span><span>    </span><span class="token token" style="color:#cc99cd">if</span><span> </span><span class="token token" style="color:#cc99cd">len</span><span class="token token" style="color:#ccc">(</span><span>user_input</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">==</span><span> </span><span class="token token" style="color:#f08d49">0</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>        exit</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span>
</span>
<span>    </span><span class="token token" style="color:#cc99cd">print</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#7ec699">&#x27;ECHO: &#x27;</span><span> </span><span class="token token" style="color:#67cdcc">+</span><span> user_input</span><span class="token token" style="color:#ccc">)</span></code></div></pre>
<p align="center">
  <video src="./static/counter-threading-1.mp4" style="width:min(100%, 800px)" preload="auto" muted="" autoplay="" loop="" playsinline="" data-wf-ignore="true" data-object-fit="cover">
</video></p>
<p>The two threads are trying to print over each other, causing the display issue we‚Äôre seeing in the demo. We can do a little hack by playing around with control characters.</p>
<ul>
<li>Printing <code>\r</code> brings the cursor to the start of the current row.</li>
<li>Printing <code>\033[F</code> brings the cursor to the start of the previous row.</li>
<li>Printing <code>\03[{n}G</code> moves the cursor <code>n</code> characters to the right.</li>
<li>Printing <code>\x1b[2K</code> clears the current line, but keeps the cursor in the same location.</li>
</ul>
<pre><div style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-python" style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>START_OF_LINE </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#7ec699">&#x27;\r&#x27;</span><span>
</span><span>LINE_UP </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#7ec699">&#x27;\033[A&#x27;</span><span>
</span><span>LINE_CLEAR </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#7ec699">&#x27;\x1b[2K&#x27;</span><span>
</span>
<span></span><span class="token token" style="color:#cc99cd">print</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#7ec699">&#x27;Hello&#x27;</span><span class="token token" style="color:#ccc">)</span><span>
</span><span></span><span class="token token" style="color:#cc99cd">print</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#7ec699">&#x27;World!&#x27;</span><span class="token token" style="color:#ccc">,</span><span> end</span><span class="token token" style="color:#67cdcc">=</span><span class="token token" style="color:#7ec699">&#x27;&#x27;</span><span class="token token" style="color:#ccc">)</span><span>
</span>
<span></span><span class="token token triple-quoted-string" style="color:#7ec699">&#x27;&#x27;&#x27;
</span><span class="token token triple-quoted-string" style="color:#7ec699">Hello
</span><span class="token token triple-quoted-string" style="color:#7ec699">World!
</span><span class="token token triple-quoted-string" style="color:#7ec699">&#x27;&#x27;&#x27;</span><span>
</span>
<span></span><span class="token token" style="color:#999"># Returns the cursor to start of row</span><span>
</span><span></span><span class="token token" style="color:#cc99cd">print</span><span class="token token" style="color:#ccc">(</span><span>START_OF_LINE</span><span class="token token" style="color:#ccc">,</span><span> end</span><span class="token token" style="color:#67cdcc">=</span><span class="token token" style="color:#7ec699">&#x27;&#x27;</span><span class="token token" style="color:#ccc">)</span><span>
</span>
<span></span><span class="token token" style="color:#999"># Moves the cursor forward 2 characters</span><span>
</span><span></span><span class="token token" style="color:#cc99cd">print</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#7ec699">&#x27;\033[3G&#x27;</span><span class="token token" style="color:#ccc">,</span><span> end</span><span class="token token" style="color:#67cdcc">=</span><span class="token token" style="color:#7ec699">&#x27;&#x27;</span><span class="token token" style="color:#ccc">)</span><span>
</span>
<span></span><span class="token token" style="color:#999"># Prints the characters `lf!` over `ord` that was</span><span>
</span><span></span><span class="token token" style="color:#999"># previously printed at that position.</span><span>
</span><span></span><span class="token token" style="color:#cc99cd">print</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#7ec699">&#x27;lf!&#x27;</span><span class="token token" style="color:#ccc">,</span><span> end</span><span class="token token" style="color:#67cdcc">=</span><span class="token token" style="color:#7ec699">&#x27;&#x27;</span><span class="token token" style="color:#ccc">)</span><span>
</span>
<span></span><span class="token token triple-quoted-string" style="color:#7ec699">&#x27;&#x27;&#x27;
</span><span class="token token triple-quoted-string" style="color:#7ec699">Hello
</span><span class="token token triple-quoted-string" style="color:#7ec699">Wolf!!
</span><span class="token token triple-quoted-string" style="color:#7ec699">&#x27;&#x27;&#x27;</span><span>
</span>
<span></span><span class="token token" style="color:#999"># Move to the first row</span><span>
</span><span></span><span class="token token" style="color:#cc99cd">print</span><span class="token token" style="color:#ccc">(</span><span>LINE_UP</span><span class="token token" style="color:#ccc">,</span><span> end</span><span class="token token" style="color:#67cdcc">=</span><span class="token token" style="color:#7ec699">&#x27;&#x27;</span><span class="token token" style="color:#ccc">)</span><span>
</span>
<span></span><span class="token token triple-quoted-string" style="color:#7ec699">&#x27;&#x27;&#x27;
</span><span class="token token triple-quoted-string" style="color:#7ec699">Hello
</span><span class="token token triple-quoted-string" style="color:#7ec699">Wolf!!
</span><span class="token token triple-quoted-string" style="color:#7ec699">&#x27;&#x27;&#x27;</span><span>
</span>
<span></span><span class="token token" style="color:#999"># Clears the first row. The cursor is still at the</span><span>
</span><span></span><span class="token token" style="color:#999"># 5th position on the first line.</span><span>
</span><span></span><span class="token token" style="color:#cc99cd">print</span><span class="token token" style="color:#ccc">(</span><span>LINE_CLEAR</span><span class="token token" style="color:#ccc">,</span><span> end</span><span class="token token" style="color:#67cdcc">=</span><span class="token token" style="color:#7ec699">&#x27;&#x27;</span><span class="token token" style="color:#ccc">)</span><span>
</span>
<span></span><span class="token token" style="color:#999"># Prints &quot;Hi&quot; on the 5th position</span><span>
</span><span></span><span class="token token" style="color:#cc99cd">print</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#7ec699">&#x27;Hi&#x27;</span><span class="token token" style="color:#ccc">,</span><span> end</span><span class="token token" style="color:#67cdcc">=</span><span class="token token" style="color:#7ec699">&#x27;&#x27;</span><span class="token token" style="color:#ccc">)</span><span>
</span>
<span></span><span class="token token triple-quoted-string" style="color:#7ec699">&#x27;&#x27;&#x27;
</span><span class="token token triple-quoted-string" style="color:#7ec699">    Hi
</span><span class="token token triple-quoted-string" style="color:#7ec699">Wolf!!
</span><span class="token token triple-quoted-string" style="color:#7ec699">&#x27;&#x27;&#x27;</span></code></div></pre>
<p>If we apply these concepts to the previous script, we can achieve something like this:</p>
<pre><div style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-python" style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token token" style="color:#cc99cd">import</span><span> threading
</span><span></span><span class="token token" style="color:#cc99cd">import</span><span> time
</span>
<span></span><span class="token token" style="color:#cc99cd">def</span><span> </span><span class="token token" style="color:#f08d49">console_counter</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>    counter </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#f08d49">1</span><span>
</span>
<span>    </span><span class="token token" style="color:#cc99cd">while</span><span> </span><span class="token token" style="color:#f08d49">True</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>        time</span><span class="token token" style="color:#ccc">.</span><span>sleep</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#f08d49">1</span><span class="token token" style="color:#ccc">)</span><span>
</span>
<span>        </span><span class="token token" style="color:#999"># Go to the start of the current line</span><span>
</span><span>        </span><span class="token token" style="color:#cc99cd">print</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#7ec699">&#x27;\r&#x27;</span><span class="token token" style="color:#ccc">,</span><span> end</span><span class="token token" style="color:#67cdcc">=</span><span class="token token" style="color:#7ec699">&#x27;&#x27;</span><span class="token token" style="color:#ccc">)</span><span>
</span>
<span>        </span><span class="token token" style="color:#999"># Print the counter and move down 1 line</span><span>
</span><span>        </span><span class="token token" style="color:#cc99cd">print</span><span class="token token" style="color:#ccc">(</span><span class="token token string-interpolation" style="color:#7ec699">f&#x27;Counter: </span><span class="token token string-interpolation interpolation" style="color:#ccc">{</span><span class="token token string-interpolation interpolation">counter</span><span class="token token string-interpolation interpolation" style="color:#ccc">}</span><span class="token token string-interpolation" style="color:#7ec699">&#x27;</span><span class="token token" style="color:#ccc">)</span><span>
</span>
<span>        counter </span><span class="token token" style="color:#67cdcc">+=</span><span> </span><span class="token token" style="color:#f08d49">1</span><span>
</span>
<!-- -->
<span>console_counter_thread </span><span class="token token" style="color:#67cdcc">=</span><span> threading</span><span class="token token" style="color:#ccc">.</span><span>Thread</span><span class="token token" style="color:#ccc">(</span><span>target</span><span class="token token" style="color:#67cdcc">=</span><span>console_counter</span><span class="token token" style="color:#ccc">,</span><span> daemon</span><span class="token token" style="color:#67cdcc">=</span><span class="token token" style="color:#f08d49">True</span><span class="token token" style="color:#ccc">)</span><span>
</span><span>console_counter_thread</span><span class="token token" style="color:#ccc">.</span><span>start</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span>
</span>
<span></span><span class="token token" style="color:#cc99cd">print</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#7ec699">&#x27;Type anything and press &quot;Enter&quot;&#x27;</span><span class="token token" style="color:#ccc">)</span><span>
</span>
<span></span><span class="token token" style="color:#cc99cd">while</span><span> </span><span class="token token" style="color:#f08d49">True</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>    user_input </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#cc99cd">input</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span>
</span><span>    </span><span class="token token" style="color:#cc99cd">if</span><span> </span><span class="token token" style="color:#cc99cd">len</span><span class="token token" style="color:#ccc">(</span><span>user_input</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">==</span><span> </span><span class="token token" style="color:#f08d49">0</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>        exit</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span>
</span>
<span>    </span><span class="token token" style="color:#cc99cd">print</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#7ec699">&#x27;ECHO: &#x27;</span><span> </span><span class="token token" style="color:#67cdcc">+</span><span> user_input</span><span class="token token" style="color:#ccc">)</span></code></div></pre>
<p align="center">
  <video src="./static/counter-threading-2.mp4" style="width:min(100%, 800px)" preload="auto" muted="" autoplay="" loop="" playsinline="" data-wf-ignore="true" data-object-fit="cover">
</video></p>
<p>Uh‚Ä¶ no.</p>
<h2>Curses Library</h2>
<p>While researching a less-janky solution, I stumbled across the ‚Äúcurses‚Äù library. curses handles screen-painting and keyboard-handling across various text-based terminals, be it VT100s, the Linux console, or other simulated terminals. Thankfully, there is also a Python wrapper for this module, which I quickly installed.</p>
<pre><div style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token token" style="color:#67cdcc">&gt;</span><span> pip </span><span class="token token" style="color:#f08d49">install</span><span> windows-curses</span></code></div></pre>
<p>(Sorry, Mac and Unix users, it only works on Windows üòõ)</p>
<p>After some experimentation, it turns out that the curses library is very low-level. For instance, this is how you‚Äôd print ‚ÄúHello World‚Äù.</p>
<pre><div style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-python" style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token token" style="color:#cc99cd">from</span><span> curses </span><span class="token token" style="color:#cc99cd">import</span><span> wrapper
</span>
<span></span><span class="token token" style="color:#cc99cd">def</span><span> </span><span class="token token" style="color:#f08d49">main</span><span class="token token" style="color:#ccc">(</span><span>stdscr</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>    </span><span class="token token" style="color:#999"># Clear the screen</span><span>
</span><span>    stdscr</span><span class="token token" style="color:#ccc">.</span><span>clear</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span>
</span>
<span>    </span><span class="token token" style="color:#999"># Print &quot;Hello world!&quot; as the coordinates (7, 5)</span><span>
</span><span>    stdscr</span><span class="token token" style="color:#ccc">.</span><span>addstr</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#f08d49">7</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#f08d49">5</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#7ec699">&#x27;Hello world!&#x27;</span><span class="token token" style="color:#ccc">)</span><span>
</span>
<span>    </span><span class="token token" style="color:#999"># Ensures that the screen has been redrawn</span><span>
</span><span>    stdscr</span><span class="token token" style="color:#ccc">.</span><span>refresh</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span>
</span>    
<span>    </span><span class="token token" style="color:#999"># Wait for user input before exiting</span><span>
</span><span>    stdscr</span><span class="token token" style="color:#ccc">.</span><span>getkey</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span>
</span>
<span>wrapper</span><span class="token token" style="color:#ccc">(</span><span>main</span><span class="token token" style="color:#ccc">)</span></code></div></pre>
<p>It also exposes a lot of low-level functionality that lets you take greater control of the console. For instance, you can refresh a specific portion of the screen if only that part has been changed. You can also define new areas called ‚Äúpads‚Äù that can be rendered separately, then displayed on the screen. In short, you can optimise the display process for faster printing and less flashing.</p>
<p>But printing to the console on such a granular level is tedious. If I implemented my raid tracker with curses, at least 90% of my code will be handling the printing and updating of the console.</p>
<p>So I did what any reasonable developer would do: spend hundreds of hours building a new console library.</p>
<h2>Snap Console</h2>
<p>Presenting the Snap Console. I wanted a library that would be easy to put together in a snap, hence the name.</p>
<p>Here are the features I wanted:</p>
<ul>
<li>Handle inputs and printing concurrently.</li>
<li>More control over the order of printed lines.</li>
</ul>
<p>What if I could modify the console output as if it were a list of rows? Something like this:</p>
<pre><div style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-python" style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>console</span><span class="token token" style="color:#ccc">.</span><span>logs</span><span class="token token" style="color:#ccc">.</span><span>append</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#7ec699">&#x27;Row 1&#x27;</span><span class="token token" style="color:#ccc">)</span><span>
</span><span>console</span><span class="token token" style="color:#ccc">.</span><span>logs</span><span class="token token" style="color:#ccc">.</span><span>append</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#7ec699">&#x27;Row 2&#x27;</span><span class="token token" style="color:#ccc">)</span><span>
</span><span>console</span><span class="token token" style="color:#ccc">.</span><span>logs </span><span class="token token" style="color:#67cdcc">+=</span><span> </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#7ec699">&#x27;Row 3&#x27;</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#7ec699">&#x27;Row 4&#x27;</span><span class="token token" style="color:#ccc">]</span><span>
</span><span>console</span><span class="token token" style="color:#ccc">.</span><span>logs</span><span class="token token" style="color:#ccc">.</span><span>pop</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span></code></div></pre>
<p>To do this, I needed to wrap a list so that when you modify it, we can trigger a callback. Thankfully, Python gives us a lot of power to override operators on your classes. For instance, we can use <code>__iadd__</code> to define how the <code>+</code> operator works on <code>WrappedList</code>s.</p>
<pre><div style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-python" style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token token" style="color:#cc99cd">class</span><span> </span><span class="token token" style="color:#f8c555">WrappedList</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#cc99cd">list</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>    </span><span class="token token triple-quoted-string" style="color:#7ec699">&quot;&quot;&quot;Creates a list that calls a callback function on edit&quot;&quot;&quot;</span><span>
</span>
<span>    </span><span class="token token" style="color:#cc99cd">def</span><span> </span><span class="token token" style="color:#f08d49">__init__</span><span class="token token" style="color:#ccc">(</span><span>self</span><span class="token token" style="color:#ccc">,</span><span> callback</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span>args</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#67cdcc">**</span><span>kwargs</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>        </span><span class="token token" style="color:#cc99cd">super</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">.</span><span>__init__</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#67cdcc">*</span><span>args</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#67cdcc">**</span><span>kwargs</span><span class="token token" style="color:#ccc">)</span><span>
</span><span>        self</span><span class="token token" style="color:#ccc">.</span><span>callback </span><span class="token token" style="color:#67cdcc">=</span><span> callback
</span>
<span>    </span><span class="token token" style="color:#cc99cd">def</span><span> </span><span class="token token" style="color:#f08d49">append</span><span class="token token" style="color:#ccc">(</span><span>self</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span>args</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#67cdcc">**</span><span>kwargs</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>        result </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#cc99cd">super</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">.</span><span>append</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#67cdcc">*</span><span>args</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#67cdcc">**</span><span>kwargs</span><span class="token token" style="color:#ccc">)</span><span>
</span><span>        self</span><span class="token token" style="color:#ccc">.</span><span>callback</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span>
</span><span>        </span><span class="token token" style="color:#cc99cd">return</span><span> result
</span>
<span>    </span><span class="token token" style="color:#cc99cd">def</span><span> </span><span class="token token" style="color:#f08d49">__iadd__</span><span class="token token" style="color:#ccc">(</span><span>self</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#67cdcc">*</span><span>args</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#67cdcc">**</span><span>kwargs</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>        result </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#cc99cd">super</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">.</span><span>__iadd__</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#67cdcc">*</span><span>args</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#67cdcc">**</span><span>kwargs</span><span class="token token" style="color:#ccc">)</span><span>
</span><span>        self</span><span class="token token" style="color:#ccc">.</span><span>callback</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span>
</span><span>        </span><span class="token token" style="color:#cc99cd">return</span><span> result
</span>
<span>    </span><span class="token token" style="color:#999"># ... Other operations</span></code></div></pre>
<p>We can then add it to the <code>SnapConsole</code> class.</p>
<pre><div style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-python" style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token token" style="color:#cc99cd">class</span><span> </span><span class="token token" style="color:#f8c555">SnapConsole</span><span class="token token" style="color:#ccc">:</span><span>    
</span><span>    </span><span class="token token" style="color:#cc99cd">def</span><span> </span><span class="token token" style="color:#f08d49">__init__</span><span class="token token" style="color:#ccc">(</span><span>self</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>        self</span><span class="token token" style="color:#ccc">.</span><span>logs </span><span class="token token" style="color:#67cdcc">=</span><span> WrappedList</span><span class="token token" style="color:#ccc">(</span><span>self</span><span class="token token" style="color:#ccc">.</span><span>refresh</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">)</span><span>
</span>
<span>    </span><span class="token token" style="color:#cc99cd">def</span><span> </span><span class="token token" style="color:#f08d49">refresh</span><span class="token token" style="color:#ccc">(</span><span>self</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>        </span><span class="token token" style="color:#999"># Placeholder function</span><span>
</span><span>        </span><span class="token token" style="color:#cc99cd">print</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#7ec699">&#x27;Update:&#x27;</span><span class="token token" style="color:#ccc">,</span><span> self</span><span class="token token" style="color:#ccc">.</span><span>logs</span><span class="token token" style="color:#ccc">)</span></code></div></pre>
<p>Now we can do:</p>
<pre><div style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-python" style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>console </span><span class="token token" style="color:#67cdcc">=</span><span> SnapConsole</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span>
</span><span>console</span><span class="token token" style="color:#ccc">.</span><span>logs</span><span class="token token" style="color:#ccc">.</span><span>append</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#7ec699">&#x27;Log 1&#x27;</span><span class="token token" style="color:#ccc">)</span><span>
</span><span>console</span><span class="token token" style="color:#ccc">.</span><span>logs</span><span class="token token" style="color:#ccc">.</span><span>append</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#7ec699">&#x27;Log 2&#x27;</span><span class="token token" style="color:#ccc">)</span><span>
</span><span>console</span><span class="token token" style="color:#ccc">.</span><span>logs </span><span class="token token" style="color:#67cdcc">+=</span><span> </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#7ec699">&#x27;Log 3&#x27;</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#7ec699">&#x27;Log 4&#x27;</span><span class="token token" style="color:#ccc">]</span><span>
</span><span></span><span class="token token" style="color:#cc99cd">print</span><span class="token token" style="color:#ccc">(</span><span>console</span><span class="token token" style="color:#ccc">.</span><span>logs</span><span class="token token" style="color:#ccc">)</span></code></div></pre>
<p>The output:</p>
<pre><div style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>Update: </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#7ec699">&#x27;Log 1&#x27;</span><span class="token token" style="color:#ccc">]</span><span>
</span><span>Update: </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#7ec699">&#x27;Log 1&#x27;</span><span>, </span><span class="token token" style="color:#7ec699">&#x27;Log 2&#x27;</span><span class="token token" style="color:#ccc">]</span><span>
</span><span>Update: </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#7ec699">&#x27;Log 1&#x27;</span><span>, </span><span class="token token" style="color:#7ec699">&#x27;Log 2&#x27;</span><span>, </span><span class="token token" style="color:#7ec699">&#x27;Log 3&#x27;</span><span>, </span><span class="token token" style="color:#7ec699">&#x27;Log 4&#x27;</span><span class="token token" style="color:#ccc">]</span></code></div></pre>
<p>This looks good so far. Each time we update the <code>logs</code> property, we can trigger a print callback. Let‚Äôs play around more.</p>
<pre><div style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-python" style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>console</span><span class="token token" style="color:#ccc">.</span><span>logs</span><span class="token token" style="color:#ccc">.</span><span>append</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#7ec699">&#x27;Log 1&#x27;</span><span class="token token" style="color:#ccc">)</span><span>
</span><span>console</span><span class="token token" style="color:#ccc">.</span><span>logs</span><span class="token token" style="color:#ccc">.</span><span>append</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#7ec699">&#x27;Log 2&#x27;</span><span class="token token" style="color:#ccc">)</span><span>
</span><span>console</span><span class="token token" style="color:#ccc">.</span><span>logs </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#7ec699">&#x27;Log 3&#x27;</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#7ec699">&#x27;Log 4&#x27;</span><span class="token token" style="color:#ccc">]</span><span>
</span><span>console</span><span class="token token" style="color:#ccc">.</span><span>logs</span><span class="token token" style="color:#ccc">.</span><span>append</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#7ec699">&#x27;Log 5&#x27;</span><span class="token token" style="color:#ccc">)</span></code></div></pre>
<p>The output:</p>
<pre><div style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>Update: </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#7ec699">&#x27;Log 1&#x27;</span><span class="token token" style="color:#ccc">]</span><span>
</span><span>Update: </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#7ec699">&#x27;Log 1&#x27;</span><span>, </span><span class="token token" style="color:#7ec699">&#x27;Log 2&#x27;</span><span class="token token" style="color:#ccc">]</span></code></div></pre>
<p>Huh, what happened here? It turns out that when we ran <code>console.logs = [&#x27;Log 3&#x27;, &#x27;Log 4&#x27;]</code>, we replaced <code>console.logs</code> with a regular list rather than a wrapped one. This means that mutations from that point onwards do not update the screen. We could force users to do something like this:</p>
<pre><div style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-python" style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>console</span><span class="token token" style="color:#ccc">.</span><span>logs </span><span class="token token" style="color:#67cdcc">=</span><span> WrappedList</span><span class="token token" style="color:#ccc">(</span><span>console</span><span class="token token" style="color:#ccc">.</span><span>refresh</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#7ec699">&#x27;Log 3&#x27;</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#7ec699">&#x27;Log 4&#x27;</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">)</span></code></div></pre>
<p>It works, but that‚Äôs really inelegant. Users are bound to forget to add the wrapper, leading to weird bugs throughout their code. Can we do better?</p>
<h3>Python Descriptors</h3>
<p>Again, Python comes to the rescue. We can define a descriptor to manage the <code>logs</code> attribute.</p>
<pre><div style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-python" style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>    </span><span class="token token" style="color:#cc99cd">class</span><span> </span><span class="token token" style="color:#f8c555">WrappedListDescriptor</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>        </span><span class="token token" style="color:#cc99cd">def</span><span> </span><span class="token token" style="color:#f08d49">__init__</span><span class="token token" style="color:#ccc">(</span><span>self</span><span class="token token" style="color:#ccc">,</span><span> callback_name</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>            </span><span class="token token" style="color:#999"># We save the name of the callback function for later access</span><span>
</span><span>            self</span><span class="token token" style="color:#ccc">.</span><span>callback_name </span><span class="token token" style="color:#67cdcc">=</span><span> callback_name
</span>
<span>        </span><span class="token token" style="color:#cc99cd">def</span><span> </span><span class="token token" style="color:#f08d49">__set_name__</span><span class="token token" style="color:#ccc">(</span><span>self</span><span class="token token" style="color:#ccc">,</span><span> owner</span><span class="token token" style="color:#ccc">,</span><span> name</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>            </span><span class="token token" style="color:#999"># We store the `logs` variable as `_logs`.</span><span>
</span><span>            </span><span class="token token" style="color:#999"># This way, `logs` can be used as a property.</span><span>
</span><span>            self</span><span class="token token" style="color:#ccc">.</span><span>private_name </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#7ec699">&#x27;_&#x27;</span><span> </span><span class="token token" style="color:#67cdcc">+</span><span> name
</span>
<span>        </span><span class="token token" style="color:#cc99cd">def</span><span> </span><span class="token token" style="color:#f08d49">__get__</span><span class="token token" style="color:#ccc">(</span><span>self</span><span class="token token" style="color:#ccc">,</span><span> instance</span><span class="token token" style="color:#ccc">,</span><span> owner</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>            </span><span class="token token" style="color:#999"># When accessing the `logs` property, return the private</span><span>
</span><span>            </span><span class="token token" style="color:#999"># `_logs` value if it is defined, otherwise initializes</span><span>
</span><span>            </span><span class="token token" style="color:#999"># an empty WrappedList</span><span>
</span><span>            cur_lst </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#cc99cd">getattr</span><span class="token token" style="color:#ccc">(</span><span>instance</span><span class="token token" style="color:#ccc">,</span><span> self</span><span class="token token" style="color:#ccc">.</span><span>private_name</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#f08d49">None</span><span class="token token" style="color:#ccc">)</span><span>
</span><span>            </span><span class="token token" style="color:#cc99cd">if</span><span> cur_lst </span><span class="token token" style="color:#cc99cd">is</span><span> </span><span class="token token" style="color:#f08d49">None</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>                callback </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#cc99cd">getattr</span><span class="token token" style="color:#ccc">(</span><span>instance</span><span class="token token" style="color:#ccc">,</span><span> self</span><span class="token token" style="color:#ccc">.</span><span>callback_name</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#cc99cd">lambda</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f08d49">None</span><span class="token token" style="color:#ccc">)</span><span>
</span><span>                new_lst </span><span class="token token" style="color:#67cdcc">=</span><span> WrappedList</span><span class="token token" style="color:#ccc">(</span><span>callback</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#ccc">]</span><span class="token token" style="color:#ccc">)</span><span>
</span><span>                </span><span class="token token" style="color:#cc99cd">setattr</span><span class="token token" style="color:#ccc">(</span><span>instance</span><span class="token token" style="color:#ccc">,</span><span> self</span><span class="token token" style="color:#ccc">.</span><span>private_name</span><span class="token token" style="color:#ccc">,</span><span> new_lst</span><span class="token token" style="color:#ccc">)</span><span>
</span><span>                </span><span class="token token" style="color:#cc99cd">return</span><span> new_lst
</span><span>            </span><span class="token token" style="color:#cc99cd">return</span><span> cur_lst
</span>
<span>        </span><span class="token token" style="color:#cc99cd">def</span><span> </span><span class="token token" style="color:#f08d49">__set__</span><span class="token token" style="color:#ccc">(</span><span>self</span><span class="token token" style="color:#ccc">,</span><span> instance</span><span class="token token" style="color:#ccc">,</span><span> new_lst</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>            </span><span class="token token" style="color:#999"># Updates the `_logs` value with a wrapped version of the list</span><span>
</span>
<span>            cur_lst </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#cc99cd">getattr</span><span class="token token" style="color:#ccc">(</span><span>instance</span><span class="token token" style="color:#ccc">,</span><span> self</span><span class="token token" style="color:#ccc">.</span><span>private_name</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#f08d49">None</span><span class="token token" style="color:#ccc">)</span><span>
</span><span>            callback </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#cc99cd">getattr</span><span class="token token" style="color:#ccc">(</span><span>instance</span><span class="token token" style="color:#ccc">,</span><span> self</span><span class="token token" style="color:#ccc">.</span><span>callback_name</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#cc99cd">lambda</span><span class="token token" style="color:#ccc">:</span><span> </span><span class="token token" style="color:#f08d49">None</span><span class="token token" style="color:#ccc">)</span><span>
</span><span>            </span><span class="token token" style="color:#cc99cd">if</span><span> new_lst </span><span class="token token" style="color:#cc99cd">is</span><span> </span><span class="token token" style="color:#cc99cd">not</span><span> cur_lst</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>                </span><span class="token token" style="color:#cc99cd">setattr</span><span class="token token" style="color:#ccc">(</span><span>instance</span><span class="token token" style="color:#ccc">,</span><span> self</span><span class="token token" style="color:#ccc">.</span><span>private_name</span><span class="token token" style="color:#ccc">,</span><span> WrappedList</span><span class="token token" style="color:#ccc">(</span><span>callback</span><span class="token token" style="color:#ccc">,</span><span> new_lst</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">)</span><span>
</span><span>            callback</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span>
</span>
<span>        </span><span class="token token" style="color:#cc99cd">def</span><span> </span><span class="token token" style="color:#f08d49">__delete__</span><span class="token token" style="color:#ccc">(</span><span>self</span><span class="token token" style="color:#ccc">,</span><span> instance</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>            </span><span class="token token" style="color:#999"># Do not allow the user to delete the `logs` attribute from the console</span><span>
</span><span>            </span><span class="token token" style="color:#cc99cd">raise</span><span> AttributeError</span></code></div></pre>
<p>I won‚Äôt go into detail of how it works, so if you‚Äôd like to learn more, check out <a href="https://docs.python.org/3/howto/descriptor.html" target="_blank" rel="noopener noreferrer">Python Descriptors</a>. Now, we can use it in SnapConsole.</p>
<pre><div style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-python" style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token token" style="color:#cc99cd">class</span><span> </span><span class="token token" style="color:#f8c555">SnapConsole</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>    logs </span><span class="token token" style="color:#67cdcc">=</span><span> WrappedListDescriptor</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#7ec699">&#x27;refresh&#x27;</span><span class="token token" style="color:#ccc">)</span><span>
</span>
<span>    </span><span class="token token" style="color:#cc99cd">def</span><span> </span><span class="token token" style="color:#f08d49">__init__</span><span class="token token" style="color:#ccc">(</span><span>self</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>        self</span><span class="token token" style="color:#ccc">.</span><span>logs </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#ccc">]</span><span>
</span>
<span>    </span><span class="token token" style="color:#cc99cd">def</span><span> </span><span class="token token" style="color:#f08d49">refresh</span><span class="token token" style="color:#ccc">(</span><span>self</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>        </span><span class="token token" style="color:#999"># Placeholder function</span><span>
</span><span>        </span><span class="token token" style="color:#cc99cd">print</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#7ec699">&#x27;Update:&#x27;</span><span class="token token" style="color:#ccc">,</span><span> self</span><span class="token token" style="color:#ccc">.</span><span>logs</span><span class="token token" style="color:#ccc">)</span></code></div></pre>
<p>We don‚Äôt even have to wrap the list in <code>__init__</code> because the descriptor does it for us! Now, when we run the following:</p>
<pre><div style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-python" style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>console</span><span class="token token" style="color:#ccc">.</span><span>logs</span><span class="token token" style="color:#ccc">.</span><span>append</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#7ec699">&#x27;Log 1&#x27;</span><span class="token token" style="color:#ccc">)</span><span>
</span><span>console</span><span class="token token" style="color:#ccc">.</span><span>logs</span><span class="token token" style="color:#ccc">.</span><span>append</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#7ec699">&#x27;Log 2&#x27;</span><span class="token token" style="color:#ccc">)</span><span>
</span><span>console</span><span class="token token" style="color:#ccc">.</span><span>logs </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#7ec699">&#x27;Log 3&#x27;</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#7ec699">&#x27;Log 4&#x27;</span><span class="token token" style="color:#ccc">]</span><span>
</span><span>console</span><span class="token token" style="color:#ccc">.</span><span>logs</span><span class="token token" style="color:#ccc">.</span><span>append</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#7ec699">&#x27;Log 5&#x27;</span><span class="token token" style="color:#ccc">)</span></code></div></pre>
<p>We get this:</p>
<pre><div style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>Update: </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#ccc">]</span><span>
</span><span>Update: </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#7ec699">&#x27;Log 1&#x27;</span><span class="token token" style="color:#ccc">]</span><span>
</span><span>Update: </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#7ec699">&#x27;Log 1&#x27;</span><span>, </span><span class="token token" style="color:#7ec699">&#x27;Log 2&#x27;</span><span class="token token" style="color:#ccc">]</span><span>
</span><span>Update: </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#7ec699">&#x27;Log 3&#x27;</span><span>, </span><span class="token token" style="color:#7ec699">&#x27;Log 4&#x27;</span><span class="token token" style="color:#ccc">]</span><span>
</span><span>Update: </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#7ec699">&#x27;Log 3&#x27;</span><span>, </span><span class="token token" style="color:#7ec699">&#x27;Log 4&#x27;</span><span>, </span><span class="token token" style="color:#7ec699">&#x27;Log 5&#x27;</span><span class="token token" style="color:#ccc">]</span></code></div></pre>
<p>Sweet!</p>
<h3>Python Context</h3>
<p>But we‚Äôre not done yet! It turns out that the curses library needs to be initialised with <code>curses.initscr()</code> and terminated with <code>curses.endwin()</code>. I‚Äôve implemented <code>SnapConsole.start()</code> and <code>SnapConsole.stop()</code>, but what if the user forgets to call <code>stop()</code>?</p>
<p>For instance, take the following code:</p>
<pre><div style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-python" style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token token" style="color:#cc99cd">try</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>    console </span><span class="token token" style="color:#67cdcc">=</span><span> SnapConsole</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span>
</span><span>    console</span><span class="token token" style="color:#ccc">.</span><span>start</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span>
</span><span>    </span><span class="token token" style="color:#999"># Do stuff</span><span>
</span><span>    console</span><span class="token token" style="color:#ccc">.</span><span>stop</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span>
</span><span></span><span class="token token" style="color:#cc99cd">except</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>    </span><span class="token token" style="color:#cc99cd">pass</span></code></div></pre>
<p>If an exception is thrown, we will exit the <code>try</code> block without closing the console! This happens way more often than we‚Äôd like to admit. Instead, can we do something like how <code>open</code> works?</p>
<pre><div style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-python" style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token token" style="color:#cc99cd">with</span><span> </span><span class="token token" style="color:#cc99cd">open</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#7ec699">&#x27;filename.txt&#x27;</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">as</span><span> f</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>    f</span><span class="token token" style="color:#ccc">.</span><span>read</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span></code></div></pre>
<p>Python once again comes to the rescue. By defining <code>__enter__</code> and <code>__exit__</code> functions, we can achieve the same functionality.</p>
<pre><div style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-python" style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token token" style="color:#cc99cd">class</span><span> </span><span class="token token" style="color:#f8c555">SnapConsole</span><span class="token token" style="color:#ccc">:</span><span>
</span>
<span>    </span><span class="token token" style="color:#cc99cd">def</span><span> </span><span class="token token" style="color:#f08d49">__enter__</span><span class="token token" style="color:#ccc">(</span><span>self</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>        self</span><span class="token token" style="color:#ccc">.</span><span>start</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span>
</span><span>        </span><span class="token token" style="color:#cc99cd">return</span><span> self
</span>
<span>    </span><span class="token token" style="color:#cc99cd">def</span><span> </span><span class="token token" style="color:#f08d49">__exit__</span><span class="token token" style="color:#ccc">(</span><span>self</span><span class="token token" style="color:#ccc">,</span><span> </span><span class="token token" style="color:#cc99cd">type</span><span class="token token" style="color:#ccc">,</span><span> value</span><span class="token token" style="color:#ccc">,</span><span> traceback</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>        self</span><span class="token token" style="color:#ccc">.</span><span>stop</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span>
</span>    
<span>    </span><span class="token token" style="color:#999"># ... other functions</span></code></div></pre>
<p>Now, we can simply start up SnapConsole like this:</p>
<pre><div style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-python" style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token token" style="color:#cc99cd">with</span><span> SnapConsole</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">as</span><span> console</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>    console</span><span class="token token" style="color:#ccc">.</span><span>logs </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#7ec699">&#x27;Success!&#x27;</span><span class="token token" style="color:#ccc">]</span></code></div></pre>
<p>And Python does all the work of closing the console for us. We‚Äôre left with defining the <code>refresh()</code> function. There‚Äôs a lot of nitty-gritty details to make it work, so I won‚Äôt go into it here.</p>
<p>But after hours of coding and debugging, we‚Äôre done! Let‚Äôs put it all together to create our counter script.</p>
<pre><div style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-python" style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token token" style="color:#cc99cd">import</span><span> asyncio
</span><span></span><span class="token token" style="color:#cc99cd">from</span><span> snapconsole </span><span class="token token" style="color:#cc99cd">import</span><span> SnapConsole
</span>
<span></span><span class="token token" style="color:#cc99cd">async</span><span> </span><span class="token token" style="color:#cc99cd">def</span><span> </span><span class="token token" style="color:#f08d49">console_counter</span><span class="token token" style="color:#ccc">(</span><span>console</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>    counter </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#f08d49">1</span><span>
</span><span>    </span><span class="token token" style="color:#cc99cd">while</span><span> </span><span class="token token" style="color:#f08d49">True</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>        </span><span class="token token" style="color:#cc99cd">await</span><span> asyncio</span><span class="token token" style="color:#ccc">.</span><span>sleep</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#f08d49">1</span><span class="token token" style="color:#ccc">)</span><span>
</span><span>        console</span><span class="token token" style="color:#ccc">.</span><span>logs</span><span class="token token" style="color:#ccc">.</span><span>append</span><span class="token token" style="color:#ccc">(</span><span class="token token string-interpolation" style="color:#7ec699">f&#x27;Counter: </span><span class="token token string-interpolation interpolation" style="color:#ccc">{</span><span class="token token string-interpolation interpolation">counter</span><span class="token token string-interpolation interpolation" style="color:#ccc">}</span><span class="token token string-interpolation" style="color:#7ec699">&#x27;</span><span class="token token" style="color:#ccc">)</span><span>
</span><span>        counter </span><span class="token token" style="color:#67cdcc">+=</span><span> </span><span class="token token" style="color:#f08d49">1</span><span>
</span>
<span></span><span class="token token" style="color:#cc99cd">async</span><span> </span><span class="token token" style="color:#cc99cd">def</span><span> </span><span class="token token" style="color:#f08d49">main</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>    </span><span class="token token" style="color:#cc99cd">with</span><span> SnapConsole</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">as</span><span> console</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>        asyncio</span><span class="token token" style="color:#ccc">.</span><span>create_task</span><span class="token token" style="color:#ccc">(</span><span>console_counter</span><span class="token token" style="color:#ccc">(</span><span>console</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">)</span><span>
</span>
<span>        </span><span class="token token" style="color:#cc99cd">async</span><span> </span><span class="token token" style="color:#cc99cd">for</span><span> user_input </span><span class="token token" style="color:#cc99cd">in</span><span> console</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>            </span><span class="token token" style="color:#cc99cd">if</span><span> </span><span class="token token" style="color:#cc99cd">len</span><span class="token token" style="color:#ccc">(</span><span>user_input</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#67cdcc">==</span><span> </span><span class="token token" style="color:#f08d49">0</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>                </span><span class="token token" style="color:#cc99cd">break</span><span>
</span><span>            console</span><span class="token token" style="color:#ccc">.</span><span>logs</span><span class="token token" style="color:#ccc">.</span><span>append</span><span class="token token" style="color:#ccc">(</span><span class="token token string-interpolation" style="color:#7ec699">f&#x27;ECHO: </span><span class="token token string-interpolation interpolation" style="color:#ccc">{</span><span class="token token string-interpolation interpolation">user_input</span><span class="token token string-interpolation interpolation" style="color:#ccc">}</span><span class="token token string-interpolation" style="color:#7ec699">&#x27;</span><span class="token token" style="color:#ccc">)</span><span>
</span>
<span>asyncio</span><span class="token token" style="color:#ccc">.</span><span>run</span><span class="token token" style="color:#ccc">(</span><span>main</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">)</span></code></div></pre>
<p>And now to test it out‚Ä¶</p>
<p align="center">
  <video src="./static/counter-snap-console.mp4" style="width:min(100%, 800px)" preload="auto" muted="" autoplay="" loop="" playsinline="" data-wf-ignore="true" data-object-fit="cover">
</video></p>
<p>Phew! Everything works as expected.</p>
<p>I could go into everything I did for the Snap Console (colours, styles, headers, and more!), but this article is long enough. If you‚Äôd like to find out more about the features, check out the <a href="https://github.com/Kenneth-LJS/snap-console" target="_blank" rel="noopener noreferrer">documentation</a>.</p>
<p>In the meantime, though, it‚Äôs time to get back to the raids.</p>
<h2>Raids and Snap Console</h2>
<p>With the Snap Console library done, I rewrote the raids tracker. Here‚Äôs the main logic:</p>
<pre><div style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-python" style="color:#ccc;background:#12171e;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token token" style="color:#cc99cd">import</span><span> asyncio
</span><span></span><span class="token token" style="color:#cc99cd">from</span><span> snapconsole </span><span class="token token" style="color:#cc99cd">import</span><span> SnapConsole</span><span class="token token" style="color:#ccc">,</span><span> LogsAlignPosition</span><span class="token token" style="color:#ccc">,</span><span> TextboxAlignPosition
</span>
<span></span><span class="token token" style="color:#cc99cd">def</span><span> </span><span class="token token" style="color:#f08d49">update_world_list</span><span class="token token" style="color:#ccc">(</span><span>world_list</span><span class="token token" style="color:#ccc">,</span><span> user_input</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>    </span><span class="token token triple-quoted-string" style="color:#7ec699">&#x27;&#x27;&#x27;
</span><span class="token token triple-quoted-string" style="color:#7ec699">        Insert logic to parse the user_input and
</span><span class="token token triple-quoted-string" style="color:#7ec699">        update the world list with the changes
</span><span class="token token triple-quoted-string" style="color:#7ec699">    &#x27;&#x27;&#x27;</span><span>
</span><span>    </span><span class="token token" style="color:#cc99cd">return</span><span> world_list
</span>
<span></span><span class="token token" style="color:#cc99cd">async</span><span> </span><span class="token token" style="color:#cc99cd">def</span><span> </span><span class="token token" style="color:#f08d49">main</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>    world_list </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#ccc">]</span><span>
</span>
<span>    </span><span class="token token" style="color:#cc99cd">with</span><span> SnapConsole</span><span class="token token" style="color:#ccc">(</span><span>
</span><span>        textbox_align_position </span><span class="token token" style="color:#67cdcc">=</span><span> TextboxAlignPosition</span><span class="token token" style="color:#ccc">.</span><span>TOP</span><span class="token token" style="color:#ccc">,</span><span>
</span><span>        logs_align_position </span><span class="token token" style="color:#67cdcc">=</span><span> LogsAlignPosition</span><span class="token token" style="color:#ccc">.</span><span>TOP</span><span class="token token" style="color:#ccc">,</span><span>
</span><span>    </span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">as</span><span> console</span><span class="token token" style="color:#ccc">:</span><span>
</span>
<span>        </span><span class="token token" style="color:#cc99cd">def</span><span> </span><span class="token token" style="color:#f08d49">refresh_worlds</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>            console</span><span class="token token" style="color:#ccc">.</span><span>logs </span><span class="token token" style="color:#67cdcc">=</span><span> </span><span class="token token" style="color:#ccc">[</span><span class="token token" style="color:#cc99cd">str</span><span class="token token" style="color:#ccc">(</span><span>world</span><span class="token token" style="color:#ccc">)</span><span> </span><span class="token token" style="color:#cc99cd">for</span><span> world </span><span class="token token" style="color:#cc99cd">in</span><span> world_list</span><span class="token token" style="color:#ccc">]</span><span>
</span>
<span>        </span><span class="token token" style="color:#cc99cd">async</span><span> </span><span class="token token" style="color:#cc99cd">def</span><span> </span><span class="token token" style="color:#f08d49">refresh_worlds_task</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>            </span><span class="token token" style="color:#cc99cd">while</span><span> </span><span class="token token" style="color:#f08d49">True</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>                refresh_worlds</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span>
</span><span>                </span><span class="token token" style="color:#cc99cd">await</span><span> asyncio</span><span class="token token" style="color:#ccc">.</span><span>sleep</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#f08d49">1</span><span class="token token" style="color:#ccc">)</span><span>
</span><span>        refresh_task </span><span class="token token" style="color:#67cdcc">=</span><span> asyncio</span><span class="token token" style="color:#ccc">.</span><span>create_task</span><span class="token token" style="color:#ccc">(</span><span>refresh_worlds_task</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">)</span><span>
</span>
<span>        refresh_worlds</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span>
</span>
<span>        </span><span class="token token" style="color:#cc99cd">async</span><span> </span><span class="token token" style="color:#cc99cd">for</span><span> user_input </span><span class="token token" style="color:#cc99cd">in</span><span> console</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>            </span><span class="token token" style="color:#cc99cd">if</span><span> user_input </span><span class="token token" style="color:#67cdcc">==</span><span> </span><span class="token token" style="color:#7ec699">&#x27;exit&#x27;</span><span class="token token" style="color:#ccc">:</span><span>
</span><span>                </span><span class="token token" style="color:#cc99cd">break</span><span>
</span>
<span>            world_list </span><span class="token token" style="color:#67cdcc">=</span><span> update_world_list</span><span class="token token" style="color:#ccc">(</span><span>world_list</span><span class="token token" style="color:#ccc">,</span><span> user_input</span><span class="token token" style="color:#ccc">)</span><span>
</span><span>            refresh_worlds</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span>
</span>
<span>        refresh_task</span><span class="token token" style="color:#ccc">.</span><span>cancel</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span>
</span>
<span>asyncio</span><span class="token token" style="color:#ccc">.</span><span>run</span><span class="token token" style="color:#ccc">(</span><span>main</span><span class="token token" style="color:#ccc">(</span><span class="token token" style="color:#ccc">)</span><span class="token token" style="color:#ccc">)</span></code></div></pre>
<p>Coding this was surprisingly easier than expected. Let‚Äôs check if it works‚Ä¶</p>
<p align="center">
  <video src="./static/raids-tracker.mp4" style="width:min(100%, 800px)" preload="auto" muted="" autoplay="" loop="" playsinline="" data-wf-ignore="true" data-object-fit="cover">
</video></p>
<p>And it does! No hacky print statements and messy outputs: everything looks perfect. That‚Äôs what you get when you have an all-powerful console library to handle things for you.</p>
<p>You can install Snap Console on PyPI <a href="https://pypi.org/project/snap-console/" target="_blank" rel="noopener noreferrer">here</a> and start using it now! Otherwise, if you‚Äôd like to check out the open-source repository, you can find it <a href="https://github.com/Kenneth-LJS/snap-console" target="_blank" rel="noopener noreferrer">here</a>.</p></div></div></section></main></div></div><footer class="footer_footer__6AImX"><div class="footer_footerContent__shqlb">Designed and built from scratch by @Kenneth-LJS with NextJS and SCSS!</div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/article/snap-console","query":{},"buildId":"IE_95hG1yeH-F73W3v0y_","nextExport":true,"autoExport":true,"isFallback":false,"scriptLoader":[]}</script></body></html>